<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.example.supringboot.mybatis.mapper.AccountMapper">
	<cache />

	<select id="getAccountByLoginId" parameterType="String"
		resultType="com.example.supringboot.domain.Account">
		SELECT * FROM Account WHERE login_id=#{login_id}
	</select>

	<insert id="insertAccount" parameterType="Account">
		INSERT INTO ACCOUNT (user_id, login_id, password, email, name, addr1, addr2, zip, phone, admin)
		VALUES (ACCOUNT_SEQ.NEXTVAL, #{login_id}, #{password}, #{email}, #{name}, #{addr1}, #{addr2}, #{zip}, #{phone}, #{admin})
	</insert>

	<select id="accountLoginCheck" resultType="Account">
		SELECT *
		FROM ACCOUNT
		WHERE login_id = #{login_id} and password = #{password}
	</select>

	<update id="updateAccount" parameterType="Account">
		UPDATE ACCOUNT SET
		password=#{password},
		email=#{email},
		name=#{name},
		addr1=#{addr1},
		addr2=#{addr2},
		zip=#{zip},
		phone=#{phone}
		WHERE user_id=#{user_id}
	</update>

	<resultMap id="itemResult" type="Item">
		<id column="item_id" jdbcType="NUMERIC" property="item_id" />
		<result column="title" jdbcType="VARCHAR" property="title" />
		<result column="end_dt" jdbcType="NUMERIC" property="end_dt" />
		<result column="item_price" jdbcType="NUMERIC"
			property="item_price" />
		<result column="ship_price" jdbcType="NUMERIC"
			property="ship_price" />
		<result column="item_status" jdbcType="VARCHAR"
			property="item_status" />
		<collection property="images" ofType="Image">
			<id property="image_id" column="image_id" />
			<result property="image" column="image" />
		</collection>
	</resultMap>
	<select id="getWishItem" parameterType="int" resultMap="itemResult">
		SELECT i.item_id, title, end_dt, item_price, ship_price, item_status, im.image_id, im.image
		FROM item i, image im, liked l
		WHERE i.item_id=l.item_id AND i.item_id=im.item_id AND l.user_id=#{user_id}
	</select>

</mapper>